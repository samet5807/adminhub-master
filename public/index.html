<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<!-- Boxicons -->
	 <link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">
	<!-- or -->
	<link rel="stylesheet"
	href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
  </head>
	<!-- My CSS -->
	<link rel="stylesheet" href="/style.css">

	<title>TESLA</title>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<style>
		/* Eklediğim yeni stil kuralları */
		#svg-turkiye-haritasi {
		  position: relative;
		  width: 100%; /* Türkiye haritasının genişliğini ayarlayın */
		  height: 500px; /* Türkiye haritasının yüksekliğini ayarlayın */
		}
	  </style>
</head>
<body>


	<!-- SIDEBAR -->
	<section id="sidebar">
		<a href="#" class="brand">
			
			
			<span class="text">TESLA</span>
			<img src="./logo.png " width="50" height="70" />
		</a>
		
		<ul class="side-menu top">
			<li class="active">
				<a href="#" class = "nav-link dashboard">>
					<i class='bx bxs-dashboard' ></i>
					<span class="text">YÖNETİM PANELİ</span>
				</a>
			</li>
			
			<li class="active">
				<a href="/istasyonlar" class = "nav-link">
					<i class='bx bxs-shopping-bag-alt' ></i>
					<span class="text">İSTASYONLAR</span>
				</a>
				
			</li>
			<li class="active">
				<a href="/grafikler" class = "nav-link">
					<i class='bx bxs-doughnut-chart' ></i>
					<span class="text">GRAFİKLER</span>
				</a>
			</li>
			<li class="active">
				<a href="/uniteler" class = "nav-link">>
					<i class='bx bxs-message-dots' ></i>
					<span class="text">Üniteler</span>
				</a>
			</li>
			<li class="active">
				<a href="/analiz" class = "nav-link">>
					<i class='bx bxs-group' ></i>
					<span class="text">ANALİZ</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
		
			<li>
				<a href="#" class="logout">
					<i class='bx bxs-log-out-circle' ></i>
					<span class="text">ÇIKIŞ</span>
				</a>
			</li>
		</ul>
	</section>
	<!-- SIDEBAR -->



	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			<i class='bx bx-menu' ></i>
			
			<form action="#">
				<div class="form-input">
					<input type="search" placeholder="Search...">
					<button type="submit" class="search-btn"><i class='bx bx-search' ></i></button>
				</div>
			</form>
			<input type="checkbox" id="switch-mode" hidden>
			<label for="switch-mode" class="switch-mode"></label>
			
			<a href="#" class="profile">
				<img src="img/people.png">
			</a>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
    
		<!-- Sadece "Yönetim Paneli" seçiliyken göster -->
		<div id="dashboard-content">
    <div class="head-title">
        <div class="left">
            <h1>PANEL</h1>
            <ul class="breadcrumb">
                <li>
                    <a href="#">YÖNETİM PANELİ</a>
                </li>
                <li><i class='bx bx-chevron-right' ></i></li>
                <li>
                    <a class="active" href="#">YÖNETİM PANELİ</a>
                </li>
            </ul>
        </div>
        <a href="#" class="btn-download">
            <i class='bx bxs-cloud-download' ></i>
            <span class="text">YENİLE</span>
        </a>
    </div>

    <ul class="box-info">
        <li>
            <i class='bx bxs-car' ></i>
            <span class="text">
                <h3>1020</h3>
                <p>Araç Sayısı</p>
            </span>
        </li>
        <li>
            <i class='bx bxs-ev-station' ></i>
            <span class="text">
                <h3>2834</h3>
                <p>İstasyonlar</p>
            </span>
        </li>
        <li>
            <i class='bx bxs-cloud-lightning' ></i>
            <span class="text">
                <h3 id="enerji-tuketimi">0</h3>
                <p>kw</p>
            </span>
        </li>
    </ul>

    <div class="table-data">
		<div class="order">
			<div class="head">
				<h3>İLLERE GÖRE İSTASYONLAR</h3>
				<i class='bx bx-search'></i>
				<i class='bx bx-filter'></i>
				<!-- İstasyonlar için çubuk grafik gösterilecek div -->
				 <div id="istasyonlarPieGrafik">
					<canvas id="istasyonlarPieChart" width="400" height="200"></canvas>
				</div>
			</div>
		</div>
		<div class="todo">
			<div class="head">
				<h3>EN ÇOK TÜKETİMİ OLAN İSTASYONLAR</h3>
				<i class='bx bx-plus'></i>
				<i class='bx bx-filter'></i>
				<!-- En çok tüketimi olan istasyonlar için çubuk grafik gösterilecek div -->
				<div id="istasyonlarBarGrafik">
					<canvas id="myChart" width="400" height="200"></canvas>
					<button onclick="fetchData()">GÜNCELLE</button>
				</div>
			</div>

			<div class="head">
				<h3>EN ÇOK ARIZA VEREN İSTASYONLAR</h3>
				<i class='bx bx-plus'></i>
				<i class='bx bx-filter'></i>
				<!-- En çok tüketimi olan istasyonlar için çubuk grafik gösterilecek div -->
				<div id="istasyonlarArızaBarGrafik">
					<canvas id="istasyonlarArızaBarChart" width="400" height="200"></canvas>
				</div>
			</div>

		</div>
	</div>
</div>
<div id="stations-content" style="display: none;">
	<!-- İstasyonlar içeriği burada bulunur -->
</div>

<div id="chart-content" style="display: none;">
	<div id="chart_div" style="width: 100%; height: 300px;"></div>
	<main>
		<!-- Sadece "Grafikler" seçiliyken göster -->
		<div class="head-title">
			<div class="left">
				<h1>Grafikler</h1>
				<ul class="breadcrumb">
					<li>
						<a href="#">Grafikler</a>
					</li>
				</ul>
			</div>
		</div>

		<!-- Grafik için bir div -->
		<div id="chart_div" style="width: 100%; height: 300px;"></div>
	</div>
	</main>
		<!-- MAIN -->
	</section>
	<!-- CONTENT -->
	


	<script src="chartUtils.js"></script>

<!-- İstasyonlar için Pasta Grafik -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const illerPie = ['İstanbul', 'Ankara', 'İzmir', 'Adana'];
        const istasyonSayilariPie = [20, 15, 10, 8];
        updatePieChart('istasyonlarPieChart', 'İstasyonlar', illerPie, istasyonSayilariPie);
    });
</script>

<!-- İstasyonlar için Çubuk Grafik -->
<script>
	
    async function fetchData(){
		const url = "http://localhost:5000/istasyon-enerji-verileri" ;
		const response = await fetch(url);
		const datapoints = await response.json();
		console.log(datapoints);
		return datapoints;
	};

	fetchData().then(datapoints => {
		const istasyon_adi = datapoints.map(function(index){
			return index.istasyon_adi;
		})
		const enerji_tuketimi= datapoints.map(function(index){
			return index.enerji_tuketimi;
		})

		

		console.log(istasyon_adi)
		console.log(enerji_tuketimi)
		myChart.config.data.labels = istasyon_adi;
		myChart.config.data.datasets[0].data = enerji_tuketimi;
		
		myChart.update();
	});
	

	// setup 
	const data = {
               
                    labels: ['pzt','salı','çrş','prş','cum','cmt','pzr'],
                    datasets: [{
                        label: 'ENERJİ TÜKETİMİ',
                        data: [18, 12, 6 , 9 ,12 ,3 ,9],
						backgroundColor: 'rgba(151, 255, 255)', // Yeşil renk
            borderColor: 'rgba(47, 79, 79)', // Yeşil renk
            borderWidth: 1
                    }]
                };
               
            

			//config 
			const config = {
				type: 'bar',
                data,
				options: {
					indexAxis: 'y',
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }

			}

			// render init block 
			const myChart = new Chart (
				document.getElementById('myChart'),
				config
			);
</script>






<!-- İstasyonlar için Çubuk Grafik -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const illerBar = ['Antalya', 'AMuş', 'Erzurum', 'Adana'];
        const kwBar = [1500, 25000, 3500, 2200];
        updateBarHataChart('istasyonlarArızaBarChart', 'HATA BİLDİRİMİ', illerBar, kwBar);
    });
</script>









<script>
	document.addEventListener("DOMContentLoaded", function () {
		// switch-mode elementini kontrol et
		const switchMode = document.getElementById('switch-mode');
	
		// varsayılan olarak dark modunu kontrol et ve sınıfı ekle
		const prefersDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
		if (prefersDarkMode) {
			document.body.classList.add('dark');
			switchMode.checked = true; // Anahtarı güncelle
		}
	
		// change olayını dinle
		switchMode.addEventListener('change', function () {
			if (this.checked) {
				document.body.classList.add('dark');
			} else {
				document.body.classList.remove('dark');
			}
		});
	});
	</script>



	<script src="script.js"></script>
	
	
	

</body>
</html>